#!/usr/bin/env node

var nemesis = require('./');
var argv = require('yargs')
  .usage('$0 {command} --region "aws_region" --group "group_name" --launch-config "launch_config" [--spot-group "spot_group"]')
  .demand(1)
  .command('command', 'Can be one of: replace')
  .alias('r', 'region')
  .alias('g', 'group')
  .alias('l', 'launch-config')
  .alias('s', 'spot-group')
  .demand(['region', 'group', 'launch-config'])
  .help('h')
  .alias('h', 'help')
  .argv;

switch(argv._[0]) {
  case 'replace':
    nemesis.replace(
      argv['region'],
      argv['group'],
      argv['launch-config']
    ).then(function(result){
      console.log('Update complete');
      process.exit(0);
    }).catch(function(err){
      console.error(err);
      process.exit(1);
    });
    break;
  default:
    console.log('Unrecognized command: "%s"', argv._[0]);
    process.exit(1);
}
